/* ============================================================
   SafeRoutes – Main Stylesheet
   Palette: purple #7C3AED · lavender #C4B5FD · white #FFFFFF
            warm-gray #F3F4F6 · coral/pink #F472B6
   ============================================================ */

/* ── CSS Variables ────────────────────────────────────────────── */
:root {
  --purple:     #7C3AED;
  --purple-dk:  #5B21B6;
  --purple-lt:  #EDE9FE;
  --lavender:   #C4B5FD;
  --pink:       #F472B6;
  --white:      #FFFFFF;
  --gray-50:    #F9FAFB;
  --gray-100:   #F3F4F6;
  --gray-200:   #E5E7EB;
  --gray-400:   #9CA3AF;
  --gray-600:   #6B7280;
  --gray-800:   #1F2937;
  --green:      #22C55E;
  --yellow:     #EAB308;
  --red:        #EF4444;
  --radius:     12px;
  --shadow-sm:  0 1px 3px rgba(0,0,0,.08);
  --shadow-md:  0 4px 16px rgba(124,58,237,.12);
  --shadow-lg:  0 8px 32px rgba(124,58,237,.18);
  --nav-h:      60px;
  --panel-w:    360px;
  --font:       'Inter', -apple-system, sans-serif;
}

/* ── Reset ────────────────────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; font-family: var(--font); color: var(--gray-800); background: var(--gray-50); }
a { color: var(--purple); text-decoration: none; }
a:hover { text-decoration: underline; }
button { font-family: var(--font); cursor: pointer; }

/* ── Navigation ───────────────────────────────────────────────── */
.navbar {
  position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
  height: var(--nav-h);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 24px;
  background: var(--white);
  border-bottom: 1px solid var(--gray-200);
  box-shadow: var(--shadow-sm);
}

.navbar-brand {
  display: flex; align-items: center; gap: 8px;
  font-size: 1.15rem; font-weight: 700; color: var(--purple);
}
.navbar-brand svg { color: var(--purple); }
.navbar-brand:hover { text-decoration: none; }

.navbar-links {
  display: flex; align-items: center; gap: 4px;
}

.nav-link {
  padding: 6px 14px; border-radius: 8px;
  font-size: 0.9rem; font-weight: 500; color: var(--gray-600);
  transition: all .15s;
}
.nav-link:hover { background: var(--gray-100); color: var(--purple); text-decoration: none; }
.nav-link.active { color: var(--purple); background: var(--purple-lt); }

.btn-nav { border-radius: 20px; border: 1px solid var(--gray-200); }
.btn-nav.btn-primary {
  background: var(--purple); color: var(--white); border-color: var(--purple);
}
.btn-nav.btn-primary:hover { background: var(--purple-dk); }

/* ── Flash messages ───────────────────────────────────────────── */
.flash-container {
  position: fixed; top: calc(var(--nav-h) + 8px); left: 50%;
  transform: translateX(-50%); z-index: 2000;
  display: flex; flex-direction: column; gap: 8px;
}
.flash {
  padding: 12px 20px; border-radius: 10px;
  font-size: 0.9rem; font-weight: 500; box-shadow: var(--shadow-md);
  animation: slideDown .2s ease;
}
.flash-success { background: #DCFCE7; color: #166534; border: 1px solid #BBF7D0; }
.flash-error   { background: #FEE2E2; color: #991B1B; border: 1px solid #FECACA; }
@keyframes slideDown { from { transform: translateY(-8px); opacity: 0; } to { opacity: 1; } }

/* ── Buttons ──────────────────────────────────────────────────── */
.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 8px;
  padding: 10px 20px; border-radius: 10px; border: none;
  font-size: 0.9rem; font-weight: 600; transition: all .15s;
}
.btn-primary { background: var(--purple); color: var(--white); }
.btn-primary:hover { background: var(--purple-dk); box-shadow: var(--shadow-md); }
.btn-outline { background: transparent; color: var(--purple); border: 1.5px solid var(--purple); }
.btn-outline:hover { background: var(--purple-lt); }
.btn-full { width: 100%; }
.btn-sm { padding: 6px 14px; font-size: 0.82rem; }
.btn:disabled { opacity: .5; cursor: not-allowed; }

/* ── Form elements ────────────────────────────────────────────── */
.form-group { margin-bottom: 18px; }
.form-label {
  display: block; margin-bottom: 6px;
  font-size: 0.85rem; font-weight: 600; color: var(--gray-800);
}
.label-hint { color: var(--purple); font-weight: 600; margin-left: 6px; }
.optional { color: var(--gray-400); font-weight: 400; }
.form-input {
  width: 100%; padding: 10px 14px; border-radius: 10px;
  border: 1.5px solid var(--gray-200); background: var(--white);
  font-size: 0.9rem; font-family: var(--font); color: var(--gray-800);
  transition: border-color .15s, box-shadow .15s;
}
.form-input:focus {
  outline: none; border-color: var(--purple);
  box-shadow: 0 0 0 3px rgba(124,58,237,.12);
}
.form-textarea { resize: vertical; min-height: 80px; }

.input-with-icon { position: relative; }
.input-with-icon .form-input { padding-right: 42px; }
.icon-btn {
  position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
  background: none; border: none; color: var(--gray-400);
  padding: 4px; display: flex; align-items: center;
}
.icon-btn:hover { color: var(--purple); }

/* ── Toggle group ─────────────────────────────────────────────── */
.toggle-group {
  display: flex; gap: 6px; flex-wrap: wrap;
}
.toggle-btn {
  padding: 7px 16px; border-radius: 8px; border: 1.5px solid var(--gray-200);
  background: var(--white); font-size: 0.85rem; font-weight: 500; color: var(--gray-600);
  transition: all .15s;
}
.toggle-btn:hover { border-color: var(--lavender); color: var(--purple); }
.toggle-btn.active { background: var(--purple-lt); border-color: var(--purple); color: var(--purple); font-weight: 600; }

/* ── Slider ───────────────────────────────────────────────────── */
.slider-row { display: flex; align-items: center; gap: 10px; margin-top: 6px; }
.slider-label { font-size: 0.75rem; color: var(--gray-400); white-space: nowrap; }
.slider {
  flex: 1; -webkit-appearance: none; height: 5px;
  background: linear-gradient(to right, var(--lavender), var(--purple));
  border-radius: 3px; cursor: pointer;
}
.slider::-webkit-slider-thumb {
  -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%;
  background: var(--purple); box-shadow: var(--shadow-sm); cursor: pointer;
}

/* ── Map page ─────────────────────────────────────────────────── */
.map-page {
  display: flex; height: 100vh; padding-top: var(--nav-h);
}

#map {
  flex: 1; z-index: 1;
}

.side-panel {
  width: var(--panel-w); min-width: var(--panel-w);
  background: var(--white);
  border-right: 1px solid var(--gray-200);
  box-shadow: var(--shadow-md);
  overflow-y: auto; z-index: 2;
  display: flex; flex-direction: column;
}

.panel-header {
  padding: 24px 24px 16px;
  background: linear-gradient(135deg, var(--purple) 0%, #A855F7 100%);
  color: var(--white);
}
.panel-title { font-size: 1.3rem; font-weight: 700; margin-bottom: 4px; }
.panel-subtitle { font-size: 0.85rem; opacity: 0.85; }
.panel-body { padding: 20px 24px; flex: 1; }

/* Route result card */
.route-card {
  margin-top: 16px; padding: 16px; border-radius: var(--radius);
  background: var(--gray-50); border: 1px solid var(--gray-200);
  animation: fadeIn .3s ease;
}
.route-stat {
  display: flex; align-items: baseline; gap: 4px;
  font-size: 1.1rem; font-weight: 700; color: var(--gray-800);
  margin-bottom: 8px;
}
.stat-icon { font-size: 1rem; }
.stat-unit { font-size: 0.75rem; font-weight: 400; color: var(--gray-400); }

.safety-bar-container {
  height: 6px; background: var(--gray-200); border-radius: 3px;
  margin: 12px 0 8px; overflow: hidden;
}
.safety-bar {
  height: 100%; border-radius: 3px;
  transition: width .5s ease, background .5s ease;
}

.legend-row {
  display: flex; align-items: center; gap: 4px;
  font-size: 0.75rem; color: var(--gray-400); margin-top: 8px;
}
.legend-dot {
  width: 8px; height: 8px; border-radius: 50%; display: inline-block;
}
.legend-dot.green  { background: var(--green);  }
.legend-dot.yellow { background: var(--yellow); }
.legend-dot.red    { background: var(--red);    }

/* Area popup */
.area-popup {
  position: absolute; bottom: 24px; right: 24px; z-index: 500;
  width: 280px; background: var(--white); border-radius: var(--radius);
  box-shadow: var(--shadow-lg); padding: 20px;
  animation: fadeIn .2s ease;
}
.popup-close {
  position: absolute; top: 10px; right: 12px;
  background: none; border: none; font-size: 1.2rem; color: var(--gray-400);
}
.popup-close:hover { color: var(--gray-800); }
.area-popup h3 { font-size: 1rem; font-weight: 700; margin-bottom: 12px; color: var(--purple); }
.popup-scores { display: flex; gap: 16px; margin-bottom: 14px; }
.popup-score-item { text-align: center; flex: 1; }
.popup-score-value { font-size: 1.3rem; font-weight: 700; color: var(--purple); display: block; }
.popup-score-label { font-size: 0.7rem; color: var(--gray-400); }

.error-card {
  margin-top: 12px; padding: 12px 16px; border-radius: 10px;
  background: #FEE2E2; color: #991B1B; font-size: 0.85rem; border: 1px solid #FECACA;
}
.success-card {
  margin-top: 12px; padding: 12px 16px; border-radius: 10px;
  background: #DCFCE7; color: #166534; font-size: 0.85rem; border: 1px solid #BBF7D0;
}
.hidden { display: none !important; }

/* ── Rate page ────────────────────────────────────────────────── */
.rate-page {
  padding-top: var(--nav-h);
  max-width: 760px; margin: 0 auto; padding-left: 20px; padding-right: 20px;
}
.rate-panel { padding: 32px 0; }
.page-title { font-size: 1.8rem; font-weight: 700; color: var(--gray-800); margin-bottom: 8px; }
.page-subtitle { color: var(--gray-600); margin-bottom: 24px; line-height: 1.6; }
.rate-map { height: 340px; border-radius: var(--radius); border: 1px solid var(--gray-200); margin-bottom: 16px; overflow: hidden; }

.selected-location {
  display: flex; align-items: center; gap: 8px;
  padding: 10px 14px; background: var(--purple-lt); border-radius: 10px;
  font-size: 0.85rem; color: var(--purple); font-weight: 500;
  margin-bottom: 20px;
}

.rating-form { display: flex; flex-direction: column; gap: 0; }

.star-rating { display: flex; gap: 8px; margin-bottom: 6px; }
.star {
  font-size: 2rem; background: none; border: none;
  color: var(--gray-200); transition: color .1s, transform .1s;
  line-height: 1;
}
.star.active, .star.hover { color: #FBBF24; transform: scale(1.1); }
.star-labels {
  display: flex; justify-content: space-between;
  font-size: 0.75rem; color: var(--gray-400);
}

/* ── Heatmap page ─────────────────────────────────────────────── */
.heatmap-page {
  display: flex; height: 100vh; padding-top: var(--nav-h);
}
.heatmap-controls {
  width: 280px; min-width: 280px; padding: 24px;
  background: var(--white); border-right: 1px solid var(--gray-200);
  overflow-y: auto; box-shadow: var(--shadow-sm);
}
.controls-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 4px; }
.controls-sub { font-size: 0.82rem; color: var(--gray-400); margin-bottom: 20px; }
.fullscreen-map { flex: 1; }

.legend { margin-top: 24px; }
.legend-title { font-size: 0.8rem; font-weight: 600; margin-bottom: 8px; }
.gradient-bar {
  height: 10px; border-radius: 5px; margin-bottom: 4px;
  background: linear-gradient(to right, #ef4444, #eab308, #22c55e);
}
.gradient-labels { display: flex; justify-content: space-between; font-size: 0.72rem; color: var(--gray-400); }

.area-list { margin-top: 20px; }
.area-list-item {
  display: flex; align-items: center; justify-content: space-between;
  padding: 8px 0; border-bottom: 1px solid var(--gray-100);
  font-size: 0.82rem;
}
.area-score-badge {
  padding: 2px 8px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;
}
.score-high  { background: #DCFCE7; color: #166534; }
.score-mid   { background: #FEF9C3; color: #854D0E; }
.score-low   { background: #FEE2E2; color: #991B1B; }

/* ── Dashboard ────────────────────────────────────────────────── */
.dashboard-page { padding-top: var(--nav-h); background: var(--gray-50); min-height: 100vh; }
.dashboard-container { max-width: 800px; margin: 0 auto; padding: 40px 20px; }

.dashboard-header {
  display: flex; align-items: center; gap: 20px; margin-bottom: 32px;
}
.avatar {
  width: 64px; height: 64px; border-radius: 50%;
  background: linear-gradient(135deg, var(--purple), var(--pink));
  display: flex; align-items: center; justify-content: center;
  font-size: 1.5rem; font-weight: 700; color: var(--white);
  flex-shrink: 0;
}
.dashboard-name { font-size: 1.5rem; font-weight: 700; }
.dashboard-uni  { font-size: 0.88rem; color: var(--gray-400); }

.stats-row { display: flex; gap: 16px; margin-bottom: 32px; flex-wrap: wrap; }
.stat-card {
  flex: 1; min-width: 120px; background: var(--white); border-radius: var(--radius);
  padding: 20px; text-align: center; box-shadow: var(--shadow-sm);
  border: 1px solid var(--gray-200);
}
.stat-number { font-size: 2rem; font-weight: 700; color: var(--purple); }
.stat-label  { font-size: 0.78rem; color: var(--gray-400); margin-top: 4px; }

.dashboard-section { margin-bottom: 32px; }
.section-title {
  font-size: 1rem; font-weight: 700; margin-bottom: 16px;
  padding-bottom: 8px; border-bottom: 2px solid var(--purple-lt);
}

.ratings-list { display: flex; flex-direction: column; gap: 10px; }
.rating-item {
  background: var(--white); border-radius: var(--radius);
  padding: 14px 18px; border: 1px solid var(--gray-200); box-shadow: var(--shadow-sm);
}
.rating-area { font-weight: 600; margin-bottom: 6px; }
.rating-meta { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
.badge {
  padding: 2px 10px; border-radius: 20px; font-size: 0.72rem; font-weight: 600;
}
.badge-day     { background: #FEF9C3; color: #854D0E; }
.badge-evening { background: #EDE9FE; color: #5B21B6; }
.badge-night   { background: #1E1B4B; color: #C7D2FE; }
.mini-stars { display: flex; gap: 1px; }
.mini-star { font-size: 0.85rem; color: var(--gray-200); }
.mini-star.filled { color: #FBBF24; }
.rating-date { font-size: 0.75rem; color: var(--gray-400); margin-left: auto; }
.rating-comment { margin-top: 8px; font-size: 0.83rem; color: var(--gray-600); font-style: italic; }

.routes-list { display: flex; flex-direction: column; gap: 10px; }
.route-item {
  background: var(--white); border-radius: var(--radius);
  padding: 14px 18px; border: 1px solid var(--gray-200); box-shadow: var(--shadow-sm);
  display: flex; align-items: center; gap: 16px; flex-wrap: wrap;
}
.route-algo-badge {
  background: var(--purple-lt); color: var(--purple);
  font-size: 0.72rem; font-weight: 700; padding: 3px 10px; border-radius: 20px;
}
.route-detail { display: flex; gap: 20px; flex: 1; }
.route-stat-val  { font-size: 1rem; font-weight: 700; color: var(--gray-800); }
.route-stat-unit { font-size: 0.72rem; color: var(--gray-400); margin-left: 2px; }

.empty-state { color: var(--gray-400); font-size: 0.9rem; }

/* ── Auth pages ───────────────────────────────────────────────── */
.auth-page {
  min-height: 100vh; padding-top: var(--nav-h);
  display: flex; align-items: center; justify-content: center;
  background: linear-gradient(135deg, var(--purple-lt) 0%, var(--gray-50) 100%);
  padding: var(--nav-h) 20px 40px;
}
.auth-card {
  width: 100%; max-width: 420px; background: var(--white);
  border-radius: 20px; padding: 40px; box-shadow: var(--shadow-lg);
  border: 1px solid var(--gray-200);
}
.auth-logo { text-align: center; margin-bottom: 20px; }
.auth-title { font-size: 1.5rem; font-weight: 700; text-align: center; margin-bottom: 6px; }
.auth-sub { text-align: center; color: var(--gray-400); font-size: 0.88rem; margin-bottom: 28px; line-height: 1.5; }
.auth-form { display: flex; flex-direction: column; }
.auth-switch { text-align: center; margin-top: 20px; font-size: 0.85rem; color: var(--gray-400); }

/* ── Animations ───────────────────────────────────────────────── */
@keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: none; } }

/* ── Responsive ───────────────────────────────────────────────── */
@media (max-width: 640px) {
  .side-panel, .heatmap-controls { width: 100%; min-width: 0; }
  .map-page { flex-direction: column; }
  #map { height: 55vh; }
  .area-popup { left: 12px; right: 12px; width: auto; bottom: 12px; }
  .navbar-links .nav-link:not(.btn-nav) { display: none; }
}
